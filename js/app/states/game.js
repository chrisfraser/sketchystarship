define(["phaser","app/entities/weapon","app/entities/player","app/entities/enemy"],function(e,t,n,r){"use strict";function i(){this.player=null,this.enemy=null,this.enemies=null,this.cursors=null,this.speed=300}return i.prototype={init:function(){this.game.renderer.renderSession.roundPixels=!0,this.physics.startSystem(e.Physics.ARCADE)},create:function(){this.setupBackground(),this.player=new n(this.game,64,200,"ship",this.speed),this.createEnemy(),this.cursors=this.input.keyboard.createCursorKeys(),this.input.keyboard.addKeyCapture([e.Keyboard.SPACEBAR]),this.input.keyboard.addKeyCapture([e.Keyboard.ESC])},update:function(){this.checkCollisions(),this.processInput()},setupBackground:function(){this.stage.backgroundColor="#DDDDDD",this.background=this.game.add.tileSprite(0,0,this.game.width,this.game.height,"back"),this.background.autoScroll(-40,0)},createEnemy:function(){this.enemy=new r(this.game,400,200,"enemy",200,250)},checkCollisions:function(){this.physics.arcade.overlap(this.player.currentWeapon,this.enemy,this.enemyHit,null,this),this.physics.arcade.overlap(this.player,this.enemy,this.playerHit,null,this)},processInput:function(){this.input.keyboard.isDown(e.Keyboard.ESC)&&this.exit()},enemyHit:function(e,t){e.kill(),t.kill();var n=this.add.sprite(t.x,t.y,"explosion");n.anchor.setTo(.5,.5),n.animations.add("boom"),n.play("boom",15,!1,!0),this.win=this.add.bitmapText(190,200,"minecraftia","You Win!",50),this.add.bitmapText(160,280,"minecraftia","(Press escape to restart)",20).tint=2241348},playerHit:function(e,t){e.kill();var n=this.add.sprite(e.x,e.y,"explosion");n.anchor.setTo(.5,.5),n.animations.add("boom"),n.play("boom",15,!1,!0),this.loose=this.add.bitmapText(190,200,"minecraftia","You Lose!",50).tint=16724804,this.add.bitmapText(160,280,"minecraftia","(Press escape to restart)",20).tint=2241348},exit:function(){this.weapons=[],this.game.state.start("menu",!0)}},i});